// jquery.kyco.popup brought to you by www.kyco.co.za. Copyright 2013 Cornelius Weidmann. Distributed under the GPL.
(function(b){b.fn.extend({kycoPopup:function(u){function g(){b("."+f).fadeIn(a.popup_fadein);b("."+m).css({"z-index":a.overlay_zindex,position:a.overlay_position,top:a.overlay_top+"px",left:a.overlay_left+"px",width:a.overlay_width,height:a.overlay_height,background:a.overlay_background,opacity:a.overlay_opacity});b("."+h).css({"z-index":a.shadow_zindex,position:a.shadow_position,border:a.shadow_border,"border-radius":a.shadow_borderradius,"box-shadow":a.shadow_boxshadow,background:a.shadow_background, opacity:a.shadow_opacity});b("."+c).css({display:"block","z-index":a.popup_zindex,position:a.popup_position,width:a.popup_width+"px",height:a.popup_height+"px"});j=document.getElementById(c).offsetWidth;k=document.getElementById(c).offsetHeight;n=a.popup_top!==p?a.popup_top:q/2-k/2;r=a.popup_left!==s?a.popup_left:t/2-j/2;b("."+c).css({top:n+"px",left:r+"px"});var d=parseInt(a.shadow_border),e=j+2*a.shadow_offset_width+d,g=k+2*a.shadow_offset_height+d,l=a.popup_top!==p?a.popup_top-a.shadow_offset_height- d-d/2:q/2-g/2-parseInt(a.shadow_border),d=a.popup_left!==s?a.popup_left-a.shadow_offset_width-d-d/2:t/2-e/2-parseInt(a.shadow_border);b("."+h).css({top:l+"px",left:d+"px",width:e+"px",height:g+"px"});if("yes"==a.close_on_popupCloser)b("."+v).on("click",function(){b("."+f).fadeOut(a.popup_fadeout)});if("yes"==a.close_on_backgroundClick)b("."+m).on("click",function(){b("."+f).fadeOut(a.popup_fadeout)});"yes"==a.close_on_ESC&&b(document).keypress(function(c){27==c.keyCode&&b("."+f).fadeOut(a.popup_fadeout)})} var c=this.attr("class"),f=c+"Container",m=c+"LockPage",h=c+"Shadow",v=c+"Closer",l=c+"Trigger",e=this.attr("class",f).attr("class"),e=this.attr("id",e).attr("id");b("."+f).css({display:"none"});var w=document.getElementById(e).innerHTML;document.getElementById(e).innerHTML='<div class="'+m+'"></div><div class="'+h+'" id="'+h+'"></div><div class="'+c+'" id="'+c+'">'+w+"</div>";var t=document.documentElement.clientWidth,q=document.documentElement.clientHeight,j=document.getElementById(c).offsetWidth, k=document.getElementById(c).offsetHeight,n=q/2-k/2,r=t/2-j/2,p=n,s=r,a=b.extend({overlay_zindex:"1000000000",overlay_position:"fixed",overlay_top:0,overlay_left:0,overlay_width:"100%",overlay_height:"100%",shadow_zindex:"1000000001",shadow_position:"fixed",shadow_top:0,shadow_left:0,popup_zindex:"1000000001",popup_position:"fixed",overlay_background:"#000",overlay_opacity:0.1,shadow_offset_width:5,shadow_offset_height:5,shadow_border:"0",shadow_borderradius:"0",shadow_boxshadow:"0",shadow_background:"#000", shadow_opacity:0.5,popup_top:p,popup_left:s,popup_width:"",popup_height:"",close_on_popupCloser:"yes",close_on_backgroundClick:"yes",close_on_ESC:"yes",trigger:"pageload",trigger_delay:0,popup_fadein:0,popup_fadeout:0},u),x='$(".'+l+'")';return this.each(function(){"pageload"==a.trigger?setTimeout(function(){g()},a.trigger_delay):a.trigger==x?b("."+l).click(function(){setTimeout(function(){g()},a.trigger_delay)}):alert("Error identifying trigger! You're trying to access an invalid element. (Use default settings to get rid of this error.)")})}})})(jQuery);